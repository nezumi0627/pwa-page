<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>PWA判定</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="manifest" href="/pwa-page/manifest.json">
</head>
<body>
  <h1>PWA 判定結果</h1>
  <p id="https">HTTPS: 判定中</p>
  <p id="manifest">Manifest: 判定中</p>
  <p id="sw">Service Worker: 判定中</p>
  <p id="result">全体結果: 判定中</p>

  <script>
    const isHttps = location.protocol === 'https:' || location.hostname === 'localhost';
    const hasManifest = !!document.querySelector('link[rel="manifest"]');
    const hasSW = 'serviceWorker' in navigator;

    document.getElementById('https').textContent = 'HTTPS: ' + (isHttps ? 'OK' : 'NG');
    document.getElementById('manifest').textContent = 'Manifest: ' + (hasManifest ? 'OK' : 'NG');
    document.getElementById('sw').textContent = 'Service Worker: ' + (hasSW ? 'OK' : 'NG');

    const allOK = isHttps && hasManifest && hasSW;
    document.getElementById('result').textContent = '全体結果: ' + (allOK ? 'PWA対応済み' : '未対応');

    if (hasSW) {
      navigator.serviceWorker.register('/pwa-page/sw.js')
        .then(() => console.log('✅ Service Worker registered'))
        .catch(err => console.error('❌ Service Worker registration failed:', err));
    }
  </script>
</body>
</html>
